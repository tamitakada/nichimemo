{% extends "base.html" %}

{% block content %}

<img src="{{ url_for('static', filename='images/nichimemo-title.svg') }}" style="width: 100px;" />
<p style="padding-top: 10px; padding-left: 10px; opacity: 40%; font-size: 12px; letter-spacing: 10px; text-align: center;">常灯日本史メモ</p>

<form style="margin: 20px 0;" action="/search" >
    <input type="text" placeholder="時代・人物・歴史出来事などを検索" autocomplete="off" name="q" {% if query|length > 0 %} value="{{ query }}" {% endif %} >
</form>

{% if memos|length > 0 %}
<div id="memo-container">
    <div class="flex-row" style="padding: 10px 0; flex: 2; justify-content: end; align-items: stretch;">
        <div class="memo" style="width: 450px; padding: 20px;">
            <div class="memo-content">
                <h2>{{ memos[0]["title"] }}</h2>
                {% for paragraph in memos[0]["markup_text"] %}
                {% if paragraph[0] == "b" %}
                    {% if loop.index == memos[0]["markup_text"]|length %}
                    <div class="memo-box" style="margin-bottom: 0; background-color: {{ paragraph[1][0][0]['box_color'] }};">
                    {% else %}
                    <div class="memo-box" style="background-color: {{ paragraph[1][0][0]['box_color'] }};">
                    {% endif %}
                {% endif %}
                
                <ul>
                {% for line in paragraph[1] %}
                    {% if paragraph[0] != "b" or loop.index > 1 %}
                    {% if line|length > 0 and "tag_type" in line[0].keys() %}
                    {% if line[0]["tag_type"] == "p" %}<div style="padding: 10px 0;">
                    {% else %}<li>{% endif %}
                    {% else %}<li>{% endif %}
                    {% for component in line %}
                        {% if "tooltip" in component.keys() and component["tooltip"]|length > 0 %}
                        <p class="memo-line-with-tooltip" style="display: inline; {{ component['style'] }}" data-tooltip="{{ component['tooltip'] }}">{{ component['text'] }}</p>
                        {% else %}
                        <p style="display: inline; {{ component['style'] }}" >{{ component['text'] }}</p>
                        {% endif %}
                    {% endfor %}
                    {% if line|length > 0 and "tag_type" in line[0].keys() %}
                    {% if line[0]["tag_type"] == "p" %}</div>
                    {% else %}</li>{% endif %}
                    {% else %}</li>{% endif %}
                    {% endif %}
                {% endfor %}
                </ul>

                {% if paragraph[0] == "b" %}</div>{% endif %}
                {% endfor %}
            </div>
        </div>
        {% for memo in memos %}
        {% if loop.index > 1 %}
        <div class="memo">
            <div class="memo-content">
                <h2>{{ memo["title"] }}</h2>
                <p>{{ memo["markup"] }}</p>
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>

    <div class="flex-row" style="padding: 10px 0; justify-content: start; overflow: auto; flex: 1;">
        <div class="tab" style="margin-left: 15px; border: 3px solid var(--navy); background-color: {{ memos[0]['era_color'] }}; box-shadow: 0 0 10px {{ memos[0]['era_color'] }};">
            <h3>{{ memos[0]["title"] }}</h3>
        </div>
        {% for memo in memos %}
        {% if loop.index > 1 %}
        <div class="tab" style="color: {{ memo['era_color'] }}; border-color: {{ memo['era_color'] }};">
            <h3>{{ memo["title"] }}</h3>
        </div>
        {% endif %}
        {% endfor %}
    </div> 
        
</div>

<script src="{{ url_for('static', filename='js/cards.js') }}"></script>

{% endif %}
{% endblock %}